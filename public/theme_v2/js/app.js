$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:location.origin});var CommonHelper={mediaTypes:["books","audiobooks","albums","games","movies"],toastr:function(t,e,n){window.toastr?toastr[n](e,t):alert(n+"! "+e)},btnAjax:function(t){t.classList.contains("running")?t.classList.remove("running","hovering","disabled"):t.classList.add("running","hovering","disabled")},blacklistStatus:function(t){this.btnAjax(t);var e=this,n=t.getAttribute("data-url"),o=t.getAttribute("data-id"),a=t.getAttribute("data-status"),i="By some reason it wasn't added to blacklist",s="error";$.ajax({url:n,method:"post",data:{id:o,status:a},success:function(n){e.btnAjax(t),n&&(i="Successfully completed.",s="success",$("#status_panel .form-check-inline").toggleClass("hidden"),$("#blacklist_add").toggleClass("hidden"),$("#blacklist_remove").toggleClass("hidden"),"active"===a&&$(".status_border_card").toggleClass("border-danger").toggleClass("border-success")),e.toastr(i,s)},error:function(n){console.error(n),e.toastr(i,s),e.btnAjax(t)}})},setStatus:function(t){this.statusPanelFadeToggle();var e=this,n=t.value,o=t.dataset.id,a=t.dataset.mediaType;if(e.mediaTypes.indexOf(a)<0)return console.error("Wrong media type is passed."),e.statusPanelToggle(!0),!1;$.ajax({url:$.ajaxSettings.url+"/content/"+a+"/status",method:"post",data:{id:o,status:n},success:function(t){e.statusPanelToggle(!t.result),e.statusPanelFadeToggle()},error:function(t){console.log(t),e.statusPanelToggle(!0),e.statusPanelFadeToggle()}})},statusPanelFadeToggle:function(){var t=$("#status_panel").find("input");t.prop("disabled",!t.prop("disabled"))},statusPanelToggle:function(t){var e=$("#status_panel"),n=e.find("#status_active"),o=e.find("#status_inactive"),a=$(".status_border_card");if(t)return n.prop("checked")?o.prop("checked",!0):n.prop("checked",!0),!1;a.toggleClass("border-danger"),a.toggleClass("border-success")},copyToClipboard:function(t){var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},initClipboardBtns:function(){if(!navigator.clipboard)return!1;let t=document.querySelectorAll("[data-clipboard]");if(t.length>0)for(let e of t){let t=document.createElement("i");t.classList.add("fas","fa-copy","ml-1","mr-1"),t.style.cursor="pointer";let n=JSON.parse(e.getAttribute("data-clipboard"));n.hasOwnProperty("float")&&n.float||(n.float="left"),$(t).hover(function(){$(t).attr("data-original-title","Copy to clipboard"),$(t).tooltip("show")}),$(t).on("click",function(){navigator.clipboard.writeText(n.value).then(()=>{t.setAttribute("data-original-title","Copied"),$(t).tooltip("show")}).catch(e=>{t.setAttribute("data-original-title","Something went wrong."),$(t).tooltip("show")})}),$(t).hide(),$(e).hover(function(){$(t).show(300)},function(){$(t).hide(300)}),"right"===n.float||"right"===n.float&&!e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[0])}}},Audiobook={},Book={},Movie={},Game={},Album={};function redirect(t){console.log(t),location.replace(location.origin+location.pathname+t)}function changeDbConnection(t){$.ajax({url:$.ajaxSettings.url+"/changeDbConnection",method:"post",data:{connectionName:t},success:function(e){e===t&&($("#db-dropdown").text(t),$(".defaultDatabase").text(t),$.notify({message:"Database connection was changed to: <b>"+e+"</b>"}))},error:function(t){console.log(t),$.notify({message:t.responseText+". Code: "+t.status},{type:"danger"})}})}$(document).ready(function(){$('[data-toggle="popover"]').popover(),$(".change-db").on("click",function(){changeDbConnection($(this).text())}),$("[type=submit]").on("click",function(){$("body").css({cursor:"progress"})}),$("#password-changing-enable").on("click",function(){$("input#password").attr("disabled",!1),$("input#password_confirmation").attr("disabled",!1)}),$(".tool-option-from-file").on("click",function(t){t.preventDefault();var e=$(this).data("triggerFile");return!!e&&($("#"+e).trigger("click"),!1)}),$(".options_file_input").on("change",function(t){t.preventDefault();var e=this,n=$(this).data("url");if(!n)return!1;var o=new FormData;if(e.files.length<1)return!1;o.append("optionData",e.files[0]);var a=$(e).closest("form").find("#option-"+e.dataset.optionName);return $.ajax({url:n,method:"post",processData:!1,contentType:!1,data:o,success:function(t){a.val(t.data),e.value=null},error:function(t){console.log(t),e.value=null}}),!1}),$(".aws-notifications button#reset").on("click",function(t){t.preventDefault();var e=$(".aws-notifications form"),n=e.find('input[name="from_date"]'),o=e.find('input[name="to_date"]'),a=e.find('select[name="bucket"]');n.val(""),o.val(""),a.val(""),e.find('button[type="submit"]').click()}),$(".aws-notifications .pagination li.page-item a.page-link").on("click",function(t){t.preventDefault();var e=$(".aws-notifications form"),n=e.find('input[name="page"]'),o=$(this).text();return n.val(o),e.find('button[type="submit"]').click(),!1}),CommonHelper.initClipboardBtns(),$(".audiobook_status_change").on("change",function(t){if(window.swal){const t=this;swal.mixin({confirmButtonClass:"btn btn-success mr-3",cancelButtonClass:"btn btn-danger",buttonsStyling:!1,focusConfirm:!1})({type:"warning",title:"Are you sure?",text:"You're going to change status.",showConfirmButton:!0,confirmButtonText:"Yes",showCancelButton:!0,cancelButtonText:"Cancel",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return CommonHelper.setStatus(t)}})}}),$(".blacklist-btn").on("click",function(){if(window.swal){const t=this;swal.mixin({confirmButtonClass:"btn btn-success mr-3",cancelButtonClass:"btn btn-danger",buttonsStyling:!1,focusConfirm:!1})({type:"warning",title:"Are you sure?",showConfirmButton:!0,confirmButtonText:"Yes",showCancelButton:!0,cancelButtonText:"Cancel",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return CommonHelper.blacklistStatus(t)}})}})});