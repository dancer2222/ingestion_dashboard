Math.randomString=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},String.prototype.getCss=function(){for(var e={},t=this.valueOf().split(";"),i=0;i<t.length;i++)if(t[i]=$.trim(t[i]),t[i]){var n=t[i].split(":");e[$.trim(n[0])]=$.trim(n[1])}return e},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.toCamel=function(){return this.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},String.prototype.toDash=function(){return this.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},String.prototype.toUnderscore=function(){return this.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})},Number.prototype.isBetween=function(e,t,i){if(i){if(this.valueOf()<=t&&this.valueOf()>=e)return!0}else if(this.valueOf()<t&&this.valueOf()>e)return!0;return!1},$.fn.insertAt=function(n,e){var t=e;if("string"==typeof e&&(t=$(e)),0==(n=Math.min(t.children().length,n)))return t.prepend(this),this;var o=this.data("index");return this.attr("data-index",n),t.find(">*:nth-child("+n+")").after(this),t.children().each(function(e,t){var i=$(t);o<n&&o<e&&e<=n?i.attr("data-index",parseInt(i.data("data-index"),10)-1):n<=o&&n<e&&e<=o&&i.attr("data-index",parseInt(i.attr("data-index"),10)+1)}),this},$.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",!1)},$.fn.enableSelection=function(){return this.removeAttr("unselectable").css("user-select","initial").off("selectstart")},$(function(){var STORAGE_PREFIX="lobipanel_",LobiPanel=function(e,t){var i=this;this.hasRandomId=!1,this.storage=null,this.$el=e,i.$el.data("inner-id")||(i.hasRandomId=!0,i.$el.attr("data-inner-id",Math.randomString(10))),this.innerId=i.$el.data("inner-id"),this.$options=i._processInput(t),i.$heading=this.$el.find(">.panel-heading"),i.$body=this.$el.find(">.panel-body"),i._init(),i.$el.css("display","none"),i._applyState(i.$options.state,i.$options.stateParams),i.$el.css("display","block"),i._applyIndex(i.$options.initialIndex)};LobiPanel.prototype={_processInput:function(e){var t=this;e||(e={}),t.hasRandomId||(t.storage=localStorage.getItem(STORAGE_PREFIX+t.innerId),t.storage=JSON.parse(t.storage)||{});var i=t._getOptionsFromAttributes();e=$.extend({},$.fn.lobiPanel.DEFAULTS,t.storage,e,i);for(var n=["unpin","reload","expand","minimize","close","editTitle"],o=0;o<n.length;o++){var a=n[o];"object"==typeof e[a]&&(e[a]=$.extend({},$.fn.lobiPanel.DEFAULTS[a],e[a],i[a]))}return e},_init:function(){var e=this;e.$el.addClass("lobipanel"),e.$heading.append(e._generateControls());var t=e.$el.parent();e._appendInnerIdToParent(t,e.innerId),e._enableSorting(),e._onToggleIconsBtnClick(),e._enableResponsiveness(),e._setBodyHeight(),e.$options.autoload&&e.load();var i="calc(100% - "+e.$heading.find(".dropdown-menu").children().length*e.$heading.find(".dropdown-menu li").first().outerWidth()+"px)";e.$heading.find(".panel-title").css("max-width",i),e._triggerEvent("init")},isPanelInit:function(){return this.$el.hasClass("lobipanel")&&this.$el.data("inner-id")},isPinned:function(){return!this.$el.hasClass("panel-unpin")},pin:function(){var e=this;return e.disableResize(),e.disableDrag(),e._enableSorting(),e._offPanelClick(),e.$el.removeClass("panel-unpin").attr("old-style",e.$el.attr("style")).removeAttr("style").css("position","relative"),e.$body.css({width:"",height:""}),e._setBodyHeight(),e._insertInParent(),e},unpin:function(){var e=this;if(e.$el.hasClass("panel-collapsed"))return e;if(e._disableSorting(),e.$el.attr("old-style"))e.$el.attr("style",e.$el.attr("old-style"));else{var t=e.$el.width(),i=e.$el.height(),n=Math.max(0,($(window).width()-e.$el.outerWidth())/2),o=Math.max(0,$(document).scrollTop()+($(window).height()-e.$el.outerHeight())/2);e.$el.css({left:n,top:o,width:t,height:i})}var a=e._getMaxZIndex();e.$el.css("z-index",a["z-index"]+1),e._onPanelClick(),e.$el.addClass("panel-unpin"),$("body").append(e.$el);var l=e._getAvailableWidth(e.$el.width()),s=e._getAvailableHeight(e.$el.height());e.$el.css({position:"absolute",width:l,height:s});var r=e._calculateBodyHeight(s),d=e._calculateBodyWidth(l);return e.$body.css({width:d,height:r}),e.$options.draggable&&e.enableDrag(),"none"!==e.$options.resize&&e.enableResize(),e},togglePin:function(){return this.isPinned()?this.unpin():this.pin(),this},isMinimized:function(){return this.$el.hasClass("panel-minimized")||this.$el.hasClass("panel-collapsed")},minimize:function(){var t=this;if(t._triggerEvent("beforeMinimize"),t.isMinimized())return t;if(t.isPinned())t.$body.slideUp(),t.$el.find(".panel-footer").slideUp(),t.$el.addClass("panel-collapsed"),t._saveState("collapsed"),t._changeClassOfControl(t.$heading.find('[data-func="minimize"]'));else{t.disableTooltips();var e,i,n=t._getFooterForMinimizedPanels(),o=n.find(">*");if(i=n.offset().top,0===o.length)e=n.offset().left;else{var a=$(o[o.length-1]);e=a.offset().left+a.width()}t.$el.hasClass("panel-expanded")||t.$el.attr("old-style",t.$el.attr("style")),t.$el.animate({left:e,top:i,width:200,height:n.height()},100,function(){t.$el.hasClass("panel-expanded")&&(t.$el.removeClass("panel-expanded"),t.$el.find(".panel-heading [data-func=expand] ."+LobiPanel.PRIVATE_OPTIONS.iconClass).removeClass(t.$options.expand.icon2).addClass(t.$options.expand.icon)),t.$el.addClass("panel-minimized"),t.$el.removeAttr("style"),t.disableDrag(),t.disableResize(),t._expandOnHeaderClick(),n.append(t.$el),$("body").addClass("lobipanel-minimized");var e="calc(100% - "+t.$heading.find(".dropdown-menu li>a:visible").length*t.$heading.find(".dropdown-menu li>a:visible").first().outerWidth()+"px)";t.$heading.find(".panel-title").css("max-width",e),t._saveState("minimized"),t._triggerEvent("onMinimize")})}return t},maximize:function(){var i=this;if(i._triggerEvent("beforeMaximize"),!i.isMinimized())return i;if(i.isPinned())i.$body.slideDown(),i.$el.find(".panel-footer").slideDown(),i.$el.removeClass("panel-collapsed"),i._saveState("pinned"),i._changeClassOfControl(i.$heading.find('[data-func="minimize"]'));else{i.enableTooltips();var e=i.$el.attr("old-style").getCss();i.$el.css({position:e.position||"fixed","z-index":e["z-index"],left:i.$el.offset().left,top:i.$el.offset().top,width:i.$el.width(),height:i.$el.height()}),$("body").append(i.$el),delete e.position,delete e["z-index"],i.$el.animate(e,100,function(){i.$el.css("position",""),i.$el.removeClass("panel-minimized"),i.$el.removeAttr("old-style"),i.$options.draggable&&i.enableDrag(),i.enableResize(),i._removeExpandOnHeaderClick();var e=i._getFooterForMinimizedPanels();0===e.children().length&&e.remove(),$("body").removeClass("lobipanel-minimized").addClass("lobipanel-minimized");var t="calc(100% - "+i.$heading.find(".dropdown-menu li").length*i.$heading.find(".dropdown-menu li").first().outerWidth()+"px)";i.$heading.find(".panel-title").css("max-width",t),i._updateUnpinnedState(),i._triggerEvent("onMaximize")})}return i},toggleMinimize:function(){return this.isMinimized()?this.maximize():this.minimize(),this},isOnFullScreen:function(){return this.$el.hasClass("panel-expanded")},toFullScreen:function(){var e=this;if(e._triggerEvent("beforeFullScreen"),e.$el.hasClass("panel-collapsed"))return e;e._changeClassOfControl(e.$heading.find('[data-func="expand"]')),e.$el.css("position","fixed");var t=e._getMaxZIndex();if(e.isPinned()||e.isMinimized()){e.enableTooltips(),e.$el.css({"z-index":t["z-index"]+1,left:e.$el.offset().left,top:e.$el.offset().top-$(window).scrollTop(),width:e.$el.width(),height:e.$el.height()}),$("body").append(e.$el);var i=e._getFooterForMinimizedPanels();0===i.children().length&&i.remove()}else e.$body.css({width:"",height:""}),e._setBodyHeight();e.isMinimized()?(e.$el.removeClass("panel-minimized"),e._removeExpandOnHeaderClick()):(e.$el.attr("old-style",e.$el.attr("style")),e.disableResize());var n=$("."+LobiPanel.PRIVATE_OPTIONS.toolbarClass).outerHeight()||0;return e.$el.animate({width:$(window).width(),height:$(window).height()-n,left:0,top:0},e.$options.expandAnimation,function(){e.$el.css({width:"",height:"",right:0,bottom:n}),e.$el.addClass("panel-expanded"),$("body").css("overflow","hidden"),e.$body.css({width:e._calculateBodyWidth(e.$el.width()),height:e._calculateBodyHeight(e.$el.height())}),e.disableDrag(),e.isPinned()&&e._disableSorting(),e._saveState("fullscreen"),e._triggerEvent("onFullScreen")}),e},toSmallSize:function(){var i=this;i._triggerEvent("beforeSmallSize"),i._changeClassOfControl(i.$heading.find('[data-func="expand"]'));var e=i.$el.attr("old-style").getCss();return i.$el.animate({position:"absolute",left:e.left,top:e.top,width:e.width,height:e.height,right:e.right,bottom:e.bottom},i.$options.collapseAnimation,function(){i.$el.removeAttr("old-style"),i.$el.hasClass("panel-unpin")?(i.$options.draggable&&i.enableDrag(),i.enableResize()):(i.$el.removeAttr("style"),i._insertInParent(),i._enableSorting()),i.$el.removeClass("panel-expanded"),$("body").css("overflow","auto");var e="",t="";i.isPinned()?"auto"!==i.$options.bodyHeight&&(t=i.$options.bodyHeight):(e=i._calculateBodyWidth(i.getWidth()),t=i._calculateBodyHeight(i.getHeight())),"auto"!==i.$options.bodyHeight?i._saveState("pinnned"):i._updateUnpinnedState(),i.$body.css({width:e,height:t}),i._triggerEvent("onSmallSize")}),i},toggleSize:function(){return this.isOnFullScreen()?this.toSmallSize():this.toFullScreen(),this},close:function(e){var t=this;e=void 0===e?100:e;return t._triggerEvent("beforeClose"),t.$el.hide(e,function(){t.isOnFullScreen()&&$("body").css("overflow","auto"),t._triggerEvent("onClose"),t.$el.remove();var e=t._getFooterForMinimizedPanels();0===e.children().length&&e.remove()}),t},setPosition:function(e,t,i){i=void 0===i?100:i;return this.isPinned()||this.$el.animate({left:e,top:t},i),this},setWidth:function(e,t){var i=this;t=void 0===t?100:t;if(i.isPinned())return i;var n=i._calculateBodyWidth(e);return i.$el.animate({width:e},t),i.$body.animate({width:n},t),i},setHeight:function(e,t){var i=this;t=void 0===t?100:t;if(i.isPinned())return i;var n=i._calculateBodyHeight(e);return i.$el.animate({height:e},t),i.$body.animate({height:n},t),i},setSize:function(e,t,i){var n=this;i=void 0===i?100:i;if(n.isPinned())return n;var o=n._calculateBodyHeight(t),a=n._calculateBodyWidth(e);return n.$el.animate({height:t,width:e},i),n.$body.animate({height:o,width:a},i),n},getPosition:function(){var e=this.$el.offset();return{x:e.left,y:e.top}},getWidth:function(){return this.$el.width()},getHeight:function(){return this.$el.height()},bringToFront:function(){var e=this;e._triggerEvent("beforeToFront");var t=e._getMaxZIndex();return t.id===e.$el.data("inner-id")||(e.$el.css("z-index",t["z-index"]+1),e._triggerEvent("onToFront")),e},enableDrag:function(){var e=this;return e.$el.draggable({handle:".panel-heading",containment:e.$options.constrain,start:function(){e.$el.css("position","absolute")},stop:function(){e.$el.css("position",""),e._updateUnpinnedState()}}),e},disableDrag:function(){return this.$el.hasClass("ui-draggable")&&this.$el.draggable("destroy"),this},enableResize:function(){var i=this,e=!1;return"vertical"===i.$options.resize?e="n, s":"horizontal"===i.$options.resize?e="e, w":"both"===i.$options.resize&&(e="all"),e&&i.$el.resizable({minWidth:i.$options.minWidth,maxWidth:i.$options.maxWidth,minHeight:i.$options.minHeight,maxHeight:i.$options.maxHeight,handles:e,start:function(){i.$el.disableSelection(),i._triggerEvent("resizeStart")},stop:function(){i.$el.enableSelection(),i._triggerEvent("resizeStop")},resize:function(){var e=i._calculateBodyHeight(i.$el.height()),t=i._calculateBodyWidth(i.$el.width());i.$body.css({width:t,height:e}),i._updateUnpinnedState(),i._triggerEvent("onResize")}}),i},disableResize:function(){return this.$el.hasClass("ui-resizable")&&this.$el.resizable("destroy"),this},startLoading:function(){var e=this._generateWindow8Spinner();return this.$el.append(e),e.find(".spinner").css("margin-top",50),this},stopLoading:function(){return this.$el.find(".spinner-wrapper").remove(),this},setLoadUrl:function(e){return this.$options.loadUrl=e,this},load:function(e){var n=this;"string"==typeof(e=e||{})&&(e={url:e});var t=e.url||n.$options.loadUrl,i=e.data||{},o=e.callback||null;return t&&(n._triggerEvent("beforeLoad"),n.startLoading(),n.$body.load(t,i,function(e,t,i){o&&"function"==typeof o&&n.callback(e,t,i),n.stopLoading(),n._triggerEvent("loaded",e,t,i)})),n},destroy:function(){var e=this;return e.disableDrag(),e.disableResize(),e.$options.sortable=!1,e._enableSorting(),e._removeInnerIdFromParent(e.innerId),e.$el.removeClass("lobipanel").removeAttr("data-inner-id").removeAttr("data-index").removeData("lobiPanel"),e.$heading.find(".dropdown").remove(),e.$el},startTitleEditing:function(){var t=this,e=t.$heading.find(".panel-title").text().trim(),i=$('<input value="'+e+'"/>');return i.on("keydown",function(e){13===e.which?t.finishTitleEditing():27===e.which&&t.cancelTitleEditing()}),t.$heading.find(".panel-title").data("old-title",e).html("").append(i),i[0].focus(),i[0].select(),t._changeClassOfControl(t.$heading.find('[data-func="editTitle"]')),t},isTitleEditing:function(){return 0<this.$heading.find(".panel-title input").length},cancelTitleEditing:function(){var e=this.$heading.find(".panel-title");return e.html(e.data("old-title")).find("input").remove(),this._changeClassOfControl(this.$heading.find('[data-func="editTitle"]')),this},finishTitleEditing:function(){var e=this,t=e.$heading.find("input");return!1===e._triggerEvent("beforeTitleChange",t.val())||(e.$heading.find(".panel-title").html(t.val()),t.remove(),e._changeClassOfControl(e.$heading.find('[data-func="editTitle"]')),e._triggerEvent("onTitleChange",t.val())),e},enableTooltips:function(){if($(window).width()<768)return this;var e=this.$heading.find(".dropdown-menu>li>a");return e.each(function(e,t){var i=$(t);i.attr("data-toggle","tooltip").attr("data-title",i.data("tooltip")).attr("data-placement","bottom")}),e.each(function(e,t){$(t).tooltip({container:"body",template:'<div class="tooltip lobipanel-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'})}),this},disableTooltips:function(){return this.$heading.find(".dropdown-menu>li>a").each(function(e,t){$(t).data("bs.tooltip")&&$(t).tooltip("destroy")}),this},_generateControls:function(){var e=this,t=e._generateDropdown(),i=t.find(".dropdown-menu");return!1!==e.$options.editTitle&&i.append(e._generateEditTitle()),!1!==e.$options.unpin&&i.append(e._generateUnpin()),!1!==e.$options.reload&&i.append(e._generateReload()),!1!==e.$options.minimize&&i.append(e._generateMinimize()),!1!==e.$options.expand&&i.append(e._generateExpand()),!1!==e.$options.close&&i.append(e._generateClose()),i.find(">li>a").on("click",function(e){e.preventDefault(),e.stopPropagation()}),t},_generateDropdown:function(){return $('<div class="dropdown"></div>').append('<ul class="dropdown-menu dropdown-menu-right"></ul>').append('<div class="dropdown-toggle" data-toggle="dropdown"><span class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+this.$options.toggleIcon+'"></div>')},_generateEditTitle:function(){var e=this.$options.editTitle,t=$('<a data-func="editTitle"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachEditTitleClickListener(t),$("<li></li>").append(t)},_attachEditTitleClickListener:function(t){var i=this;t.on("mousedown",function(e){e.stopPropagation()}),t.on("click",function(e){e.stopPropagation(),i.hideTooltip(t),i.isTitleEditing()?i.finishTitleEditing():i.startTitleEditing()})},hideTooltip:function(e){return e.data("bs.tooltip")&&e.tooltip("hide"),this},_generateUnpin:function(){var e=this.$options.unpin,t=$('<a data-func="unpin"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachUnpinClickListener(t),$("<li></li>").append(t)},_attachUnpinClickListener:function(e){var t=this;e.on("mousedown",function(e){e.stopPropagation()}),e.on("click",function(){t.hideTooltip(e),t.doTogglePin()})},_generateReload:function(){var e=this.$options.reload,t=$('<a data-func="reload"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachReloadClickListener(t),$("<li></li>").append(t)},_attachReloadClickListener:function(e){var t=this;e.on("mousedown",function(e){e.stopPropagation()}),e.on("click",function(){t.hideTooltip(e),t.load()})},_generateMinimize:function(){var e=this.$options.minimize,t=$('<a data-func="minimize"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachMinimizeClickListener(t),$("<li></li>").append(t)},_attachMinimizeClickListener:function(t){var i=this;t.on("mousedown",function(e){e.stopPropagation()}),t.on("click",function(e){e.stopPropagation(),i.hideTooltip(t),i.toggleMinimize()})},_generateExpand:function(){var e=this.$options.expand,t=$('<a data-func="expand"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachExpandClickListener(t),$("<li></li>").append(t)},_attachExpandClickListener:function(t){var i=this;t.on("mousedown",function(e){e.stopPropagation()}),t.on("click",function(e){e.stopPropagation(),i.hideTooltip(t),i.toggleSize()})},_generateClose:function(){var e=this.$options.close,t=$('<a data-func="close"></a>');return t.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+e.icon+'"></i>'),e.tooltip&&"string"==typeof e.tooltip&&(t.append('<span class="control-title">'+e.tooltip+"</span>"),t.attr("data-tooltip",e.tooltip)),this._attachCloseClickListener(t),$("<li></li>").append(t)},_attachCloseClickListener:function(t){var i=this;t.on("mousedown",function(e){e.stopPropagation()}),t.on("click",function(e){e.stopPropagation(),i.hideTooltip(t),i.close()})},_getMaxZIndex:function(){var e,t,i,n=$(".lobipanel.panel-unpin:not(.panel-minimized.panel-expanded)");if(0===n.length)return{id:"","z-index":LobiPanel.PRIVATE_OPTIONS.initialZIndex};e=$(n[0]).attr("style");var o=$(n[0]).data("inner-id");t=e?e.getCss()["z-index"]:LobiPanel.PRIVATE_OPTIONS.initialZIndex;for(var a=1;a<n.length;a++)t<(i=(e=$(n[a]).attr("style"))?e.getCss()["z-index"]:0)&&(o=$(n[a]).data("inner-id"),t=i);return{id:o,"z-index":parseInt(t,10)}},_onPanelClick:function(){var e=this;e.$el.on("mousedown.lobiPanel",function(){if(e.isPinned()||e.isMinimized()||e.isOnFullScreen())return!1;e.bringToFront()})},_offPanelClick:function(){this.$el.off("mousedown.lobiPanel")},_changeClassOfControl:function(e){e=$(e);var t=this.$options[e.attr("data-func")];t.icon&&e.find("."+LobiPanel.PRIVATE_OPTIONS.iconClass).toggleClass(t.icon).toggleClass(t.icon2)},_getFooterForMinimizedPanels:function(){var e=$("."+LobiPanel.PRIVATE_OPTIONS.toolbarClass);return 0===e.length&&(e=$('<div class="'+LobiPanel.PRIVATE_OPTIONS.toolbarClass+'"></div>'),$("body").append(e)),e},_expandOnHeaderClick:function(){var e=this;e.$heading.on("click.lobiPanel",function(){e.maximize(),e.bringToFront()})},_removeExpandOnHeaderClick:function(){this.$heading.off("click.lobiPanel")},_getAvailableWidth:function(e){return this.$options.maxWidth&&(e=Math.min(e,this.$options.maxWidth)),this.$options.minWidth&&(e=Math.max(e,this.$options.minWidth)),e},_getAvailableHeight:function(e){return this.$options.maxHeight&&(e=Math.min(e,this.$options.maxHeight)),this.$options.minHeight&&(e=Math.max(e,this.$options.minHeight)),e},_calculateBodyHeight:function(e){return e-this.$heading.outerHeight()-this.$el.find(".panel-footer").outerHeight()},_calculateBodyWidth:function(e){return e-2},_appendInnerIdToParent:function(e,t){if(void 0===e.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr))e.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,t);else{if(-1<e.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr).indexOf(t))return;var i=e.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr);e.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,i+" "+t)}this.$el.attr("data-index",this.$el.index())},_insertInParent:function(){var e=$("["+LobiPanel.PRIVATE_OPTIONS.parentAttr+"~="+this.innerId+"]");this.$el.insertAt(this.$el.attr("data-index"),e)},_generateWindow8Spinner:function(){var e=['<div class="spinner spinner-windows8">','<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>","</div>"].join("");return $('<div class="spinner-wrapper">'+e+"</div>")},_enableSorting:function(){var n=this,e=n.$el.parent();e.hasClass("ui-sortable")&&e.sortable("destroy"),n.$options.sortable?(n.$el.addClass("lobipanel-sortable"),e.addClass("lobipanel-parent-sortable")):n.$el.removeClass("lobipanel-sortable"),e.sortable({connectWith:".lobipanel-parent-sortable",items:".lobipanel-sortable",handle:".panel-heading",cursor:"move",placeholder:"lobipanel-placeholder",forcePlaceholderSize:!0,opacity:.7,revert:300,update:function(e,t){var i=t.item.data("inner-id");n._removeInnerIdFromParent(i),n._appendInnerIdToParent(t.item.parent(),i),n._updateDataIndices(t.item),n._triggerEvent("dragged")}})},_disableSorting:function(){var e=this.$el.parent();e.hasClass("ui-sortable")&&e.sortable("destroy")},_updateDataIndices:function(e){e.parent().children().each(function(e,t){$(t).attr("data-index",e);var i=$(t).data("lobiPanel");i&&i.$options.stateful&&!i.hasRandomId&&i._saveState("pinned",{index:e})}),console.log("Save indices in localstorage")},_removeInnerIdFromParent:function(e){var t=$("["+LobiPanel.PRIVATE_OPTIONS.parentAttr+"~="+e+"]"),i=t.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr).replace(e,"").trim().replace(/\s{2,}/g," ");t.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,i)},_onToggleIconsBtnClick:function(){var e=this;e.$heading.find(".toggle-controls").on("click.lobiPanel",function(){e.$el.toggleClass("controls-expanded")})},_adjustForScreenSize:function(){var e=this;e.disableTooltips(),768<$(window).width()&&e.$options.tooltips&&e.enableTooltips(),e.isOnFullScreen()&&e.$body.css({width:e._calculateBodyWidth(e.$el.width()),height:e._calculateBodyHeight(e.$el.height())})},_enableResponsiveness:function(){var e=this;e._adjustForScreenSize(),$(window).on("resize.lobiPanel",function(){e._adjustForScreenSize()})},_setBodyHeight:function(){"auto"!==this.$options.bodyHeight&&this.$body.css({height:this.$options.bodyHeight,overflow:"auto"})},_getOptionsFromAttributes:function(){var me=this,$el=me.$el,options={};for(var key in $.fn.lobiPanel.DEFAULTS){var k=key.toDash(),val=$el.data(k);void 0!==val&&("object"!=typeof $.fn.lobiPanel.DEFAULTS[key]?options[key]=val:options[key]=eval("("+val+")"))}return options},_saveState:function(e,t){var i=this;console.log("Save state ",e,t),!i.hasRandomId&&i.$options.stateful&&(i.storage.state=e,t&&(i.storage.stateParams=t),i._saveLocalStorage(i.storage))},_saveLocalStorage:function(e){localStorage.setItem(STORAGE_PREFIX+this.innerId,JSON.stringify(e))},_applyState:function(e,t){var i=this;switch(e){case"pinned":t&&null!==t.index&&void 0!==t.index&&i._applyIndex(t.index);break;case"unpinned":i.unpin(),i.setPosition(t.left,t.top,0),i.setSize(t.width,t.height,0);break;case"minimized":i.unpin(),i.minimize();break;case"collapsed":i.minimize();break;case"fullscreen":i.toFullScreen()}},_applyIndex:function(e){null!==e&&this.$el.insertAt(e,this.$el.parent())},_triggerEvent:function(e){var t=this,i=Array.prototype.slice.call(arguments,1);return i.unshift(t),t.$el.trigger(e+".lobiPanel",i),!t.$options[e]||"function"!=typeof t.$options[e]||t.$options[e].apply(t,i)},doPin:function(){var e=this;return!1!==e._triggerEvent("beforePin")&&(e.pin(),e._saveState("pinned"),e._triggerEvent("onPin")),e},doUnpin:function(){var e=this;return!1!==e._triggerEvent("beforeUnpin")&&(e.unpin(),e._updateUnpinnedState(),e._triggerEvent("onUnpin")),e},doTogglePin:function(){return this.isPinned()?this.doUnpin():this.doPin(),this},_updateUnpinnedState:function(){this._saveState("unpinned",this.getAlignment())},getAlignment:function(){return{top:this.$el.css("top"),left:this.$el.css("left"),width:this.$el.css("width"),height:this.$el.css("height")}}},$.fn.lobiPanel=function(n){var o=arguments,a=null;return this.each(function(){var e=$(this),t=e.data("lobiPanel"),i="object"==typeof n&&n;t||e.data("lobiPanel",t=new LobiPanel(e,i)),"string"==typeof n&&(o=Array.prototype.slice.call(o,1),a=t[n].apply(t,o))}),a},LobiPanel.PRIVATE_OPTIONS={parentAttr:"data-lobipanel-child-inner-id",toolbarClass:"lobipanel-minimized-toolbar",initialZIndex:1e4,iconClass:"panel-control-icon"},$.fn.lobiPanel.DEFAULTS={draggable:!0,sortable:!1,connectWith:".ui-sortable",resize:"both",minWidth:200,minHeight:100,maxWidth:1200,maxHeight:700,loadUrl:"",autoload:!0,bodyHeight:"auto",tooltips:!0,toggleIcon:"glyphicon glyphicon-cog",expandAnimation:100,collapseAnimation:100,state:"pinned",initialIndex:null,stateful:!1,constrain:"document",unpin:{icon:"glyphicon glyphicon-move",tooltip:"Unpin"},reload:{icon:"glyphicon glyphicon-refresh",tooltip:"Reload"},minimize:{icon:"glyphicon glyphicon-minus",icon2:"glyphicon glyphicon-plus",tooltip:"Minimize"},expand:{icon:"glyphicon glyphicon-resize-full",icon2:"glyphicon glyphicon-resize-small",tooltip:"Fullscreen"},close:{icon:"glyphicon glyphicon-remove",tooltip:"Close"},editTitle:{icon:"glyphicon glyphicon-pencil",icon2:"glyphicon glyphicon-floppy-disk",tooltip:"Edit title"},beforeTitleChange:null},$(".lobipanel").lobiPanel()});